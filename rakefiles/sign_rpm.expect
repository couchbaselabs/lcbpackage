#!/usr/bin/expect -f

set gpgName [lrange $argv 0 0]
set repo [lrange $argv 1 1]

foreach rpmfile [exec find $repo -name *.rpm] {
        spawn rpm --resign -D "_signature gpg" -D "_gpg_name $gpgName" $rpmfile
        expect -exact "Enter pass phrase: "
        send -- "\r"
	expect eof
	wait
}
